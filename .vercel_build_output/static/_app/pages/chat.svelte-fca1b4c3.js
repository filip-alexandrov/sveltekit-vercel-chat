import{S as ue,i as fe,s as _e,e as g,k as I,t as A,c as y,a as R,m as U,h as N,d as _,a1 as le,b as d,f as C,g as w,J as v,j as me,K as B,l as K,o as D,p as X,q as S,a2 as de,a3 as se,a4 as pe,a5 as he,L as we,n as Y,a6 as be,a7 as ge,P as ye,R as ae,T as ve,w as ke,x as Ee,y as Le,z as Re,A as Be,B as Ie,a8 as Ue,C as Ce}from"../chunks/vendor-0af294cd.js";import{g as re,a as oe,d as ie}from"../chunks/navigation-bed5ce12.js";import"../chunks/singletons-d1fb5791.js";function Pe(u){let e,s,i,t,l,r,n,c,f;return{c(){e=g("div"),s=g("img"),t=I(),l=g("span"),r=A(u[3]),this.h()},l(p){e=y(p,"DIV",{title:!0,style:!0});var a=R(e);s=y(a,"IMG",{src:!0,style:!0,class:!0,alt:!0}),t=U(a),l=y(a,"SPAN",{class:!0,style:!0});var m=R(l);r=N(m,u[3]),m.forEach(_),a.forEach(_),this.h()},h(){le(s.src,i=u[0]||`https://www.gravatar.com/avatar/${u[2]}?d=mp&s=32&r=g`)||d(s,"src",i),C(s,"width","32px"),C(s,"height","32px"),d(s,"class","w3-circle"),d(s,"alt","avatar"),d(l,"class",n=(u[5]?"w3-blue":"w3-light-gray")+" w3-padding w3-round-xxlarge"),C(l,"margin","0 6px"),d(e,"title",c=`${u[2]} (${u[4]}) at ${new Date(u[1])}`),d(e,"style",f="display: flex; margin-bottom: 0.5rem; "+(u[5]&&"flex-direction: row-reverse; ")+"align-items: center;")},m(p,a){w(p,e,a),v(e,s),v(e,t),v(e,l),v(l,r)},p(p,[a]){a&5&&!le(s.src,i=p[0]||`https://www.gravatar.com/avatar/${p[2]}?d=mp&s=32&r=g`)&&d(s,"src",i),a&8&&me(r,p[3]),a&32&&n!==(n=(p[5]?"w3-blue":"w3-light-gray")+" w3-padding w3-round-xxlarge")&&d(l,"class",n),a&22&&c!==(c=`${p[2]} (${p[4]}) at ${new Date(p[1])}`)&&d(e,"title",c),a&32&&f!==(f="display: flex; margin-bottom: 0.5rem; "+(p[5]&&"flex-direction: row-reverse; ")+"align-items: center;")&&d(e,"style",f)},i:B,o:B,d(p){p&&_(e)}}}function Ae(u,e,s){let{photoURL:i}=e,{createdAt:t}=e,{email:l}=e,{message:r}=e,{uid:n}=e,{self:c=!1}=e;return u.$$set=f=>{"photoURL"in f&&s(0,i=f.photoURL),"createdAt"in f&&s(1,t=f.createdAt),"email"in f&&s(2,l=f.email),"message"in f&&s(3,r=f.message),"uid"in f&&s(4,n=f.uid),"self"in f&&s(5,c=f.self)},[i,t,l,r,n,c]}class Ne extends ue{constructor(e){super();fe(this,e,Ae,Pe,_e,{photoURL:0,createdAt:1,email:2,message:3,uid:4,self:5})}}function ne(u,e,s){const i=u.slice();return i[8]=e[s],i}function Se(u){let e,s;return{c(){e=g("p"),s=A("Not logged in!"),this.h()},l(i){e=y(i,"P",{class:!0});var t=R(e);s=N(t,"Not logged in!"),t.forEach(_),this.h()},h(){d(e,"class","w3-center w3-section")},m(i,t){w(i,e,t),v(e,s)},p:B,i:B,o:B,d(i){i&&_(e)}}}function De(u){let e,s,i,t,l,r,n,c,f,p,a,m,b,F,Q,E,L,V,z,H,k,M,O,G,J,T,W,Z;const x=[je,qe],P=[];function $(o,h){return o[1].length>0?0:1}return E=$(u),L=P[E]=x[E](u),{c(){e=g("h1"),s=A("Serverless chat"),i=I(),t=g("p"),l=A("Chatroom"),r=I(),n=g("p"),c=g("button"),f=A("Logout"),p=I(),a=g("br"),m=I(),b=g("div"),F=g("br"),Q=I(),L.c(),V=I(),z=g("br"),H=I(),k=g("input"),G=I(),J=g("br"),this.h()},l(o){e=y(o,"H1",{class:!0});var h=R(e);s=N(h,"Serverless chat"),h.forEach(_),i=U(o),t=y(o,"P",{class:!0});var q=R(t);l=N(q,"Chatroom"),q.forEach(_),r=U(o),n=y(o,"P",{class:!0});var ee=R(n);c=y(ee,"BUTTON",{class:!0});var te=R(c);f=N(te,"Logout"),te.forEach(_),ee.forEach(_),p=U(o),a=y(o,"BR",{}),m=U(o),b=y(o,"DIV",{class:!0,style:!0});var j=R(b);F=y(j,"BR",{}),Q=U(j),L.l(j),V=U(j),z=y(j,"BR",{id:!0}),j.forEach(_),H=U(o),k=y(o,"INPUT",{type:!0,style:!0,placeholder:!0,class:!0,id:!0}),G=U(o),J=y(o,"BR",{}),this.h()},h(){d(e,"class","w3-jumbo w3-center"),d(t,"class","w3-center"),d(c,"class","w3-button w3-blue"),d(n,"class","w3-center"),d(z,"id","scroll-to"),d(b,"class","w3-container w3-border w3-border-gray"),C(b,"margin","0 auto"),C(b,"width","60%"),C(b,"height","600px"),C(b,"overflow-y","auto"),d(k,"type","text"),C(k,"margin","0 auto"),C(k,"width","60%"),C(k,"margin-top","-1px"),d(k,"placeholder",M=u[2]?"3 second cooldown":"Enter message and press enter"),d(k,"class",O="w3-input w3-border w3-border-gray "+(u[2]&&"w3-pale-red")),d(k,"id","message-input")},m(o,h){w(o,e,h),v(e,s),w(o,i,h),w(o,t,h),v(t,l),w(o,r,h),w(o,n,h),v(n,c),v(c,f),w(o,p,h),w(o,a,h),w(o,m,h),w(o,b,h),v(b,F),v(b,Q),P[E].m(b,null),v(b,V),v(b,z),w(o,H,h),w(o,k,h),w(o,G,h),w(o,J,h),T=!0,W||(Z=[ae(c,"click",u[5]),ae(k,"keydown",u[4])],W=!0)},p(o,h){let q=E;E=$(o),E===q?P[E].p(o,h):(Y(),D(P[q],1,1,()=>{P[q]=null}),X(),L=P[E],L?L.p(o,h):(L=P[E]=x[E](o),L.c()),S(L,1),L.m(b,V)),(!T||h&4&&M!==(M=o[2]?"3 second cooldown":"Enter message and press enter"))&&d(k,"placeholder",M),(!T||h&4&&O!==(O="w3-input w3-border w3-border-gray "+(o[2]&&"w3-pale-red")))&&d(k,"class",O)},i(o){T||(S(L),T=!0)},o(o){D(L),T=!1},d(o){o&&_(e),o&&_(i),o&&_(t),o&&_(r),o&&_(n),o&&_(p),o&&_(a),o&&_(m),o&&_(b),P[E].d(),o&&_(H),o&&_(k),o&&_(G),o&&_(J),W=!1,ve(Z)}}}function Te(u){let e,s,i;return{c(){e=g("p"),s=g("i"),i=A(" Loading"),this.h()},l(t){e=y(t,"P",{class:!0});var l=R(e);s=y(l,"I",{class:!0}),R(s).forEach(_),i=N(l," Loading"),l.forEach(_),this.h()},h(){d(s,"class","fas fa-spinner w3-spin fa-3x"),d(e,"class","w3-center w3-section")},m(t,l){w(t,e,l),v(e,s),v(e,i)},p:B,i:B,o:B,d(t){t&&_(e)}}}function qe(u){let e,s;return{c(){e=g("p"),s=A("Looks like nobody's sent a message. Be the first!"),this.h()},l(i){e=y(i,"P",{class:!0});var t=R(e);s=N(t,"Looks like nobody's sent a message. Be the first!"),t.forEach(_),this.h()},h(){d(e,"class","w3-center w3-text-gray")},m(i,t){w(i,e,t),v(e,s)},p:B,i:B,o:B,d(i){i&&_(e)}}}function je(u){let e,s,i=u[1],t=[];for(let r=0;r<i.length;r+=1)t[r]=ce(ne(u,i,r));const l=r=>D(t[r],1,1,()=>{t[r]=null});return{c(){for(let r=0;r<t.length;r+=1)t[r].c();e=K()},l(r){for(let n=0;n<t.length;n+=1)t[n].l(r);e=K()},m(r,n){for(let c=0;c<t.length;c+=1)t[c].m(r,n);w(r,e,n),s=!0},p(r,n){if(n&3){i=r[1];let c;for(c=0;c<i.length;c+=1){const f=ne(r,i,c);t[c]?(t[c].p(f,n),S(t[c],1)):(t[c]=ce(f),t[c].c(),S(t[c],1),t[c].m(e.parentNode,e))}for(Y(),c=i.length;c<t.length;c+=1)l(c);X()}},i(r){if(!s){for(let n=0;n<i.length;n+=1)S(t[n]);s=!0}},o(r){t=t.filter(Boolean);for(let n=0;n<t.length;n+=1)D(t[n]);s=!1},d(r){Ue(t,r),r&&_(e)}}}function ce(u){let e,s;const i=[u[8],{self:u[0].uid===u[8].uid}];let t={};for(let l=0;l<i.length;l+=1)t=Ce(t,i[l]);return e=new Ne({props:t}),{c(){ke(e.$$.fragment)},l(l){Ee(e.$$.fragment,l)},m(l,r){Le(e,l,r),s=!0},p(l,r){const n=r&3?Re(i,[r&2&&Be(l[8]),{self:l[0].uid===l[8].uid}]):{};e.$set(n)},i(l){s||(S(e.$$.fragment,l),s=!0)},o(l){D(e.$$.fragment,l),s=!1},d(l){Ie(e,l)}}}function Ve(u){let e,s,i,t,l,r,n;const c=[Te,De,Se],f=[];function p(a,m){return typeof a[0]=="undefined"?0:a[0]?1:2}return t=p(u),l=f[t]=c[t](u),{c(){e=g("p"),s=A(u[3]),i=I(),l.c(),r=K()},l(a){e=y(a,"P",{});var m=R(e);s=N(m,u[3]),m.forEach(_),i=U(a),l.l(a),r=K()},m(a,m){w(a,e,m),v(e,s),w(a,i,m),f[t].m(a,m),w(a,r,m),n=!0},p(a,[m]){(!n||m&8)&&me(s,a[3]);let b=t;t=p(a),t===b?f[t].p(a,m):(Y(),D(f[b],1,1,()=>{f[b]=null}),X(),l=f[t],l?l.p(a,m):(l=f[t]=c[t](a),l.c()),S(l,1),l.m(r.parentNode,r))},i(a){n||(S(l),n=!0)},o(a){D(l),n=!1},d(a){a&&_(e),a&&_(i),f[t].d(a),a&&_(r)}}}function ze(u,e,s){const i=de(se(ie,"messages")),t=pe(i,a=>{a.docChanges().forEach(m=>{m.type==="added"&&(s(1,r=[...r,m.doc.data()]),setTimeout(()=>{document.getElementById("scroll-to")&&document.getElementById("scroll-to").scrollIntoView({behavior:"smooth"})},500)),m.type==="modified"&&console.log("Modified city: ",m.doc.data()),m.type==="removed"&&console.log("Removed city: ",m.doc.data())})});he(t);let l,r=[],n=!1;async function c(a){if(a.key.toLowerCase()!=="enter"||n)return;const m=new be().clean((document.getElementById("message-input").value||"").trim());!m||(document.getElementById("message-input").value="",s(2,n=!0),setTimeout(()=>s(2,n=!1),3e3),await ge(se(ie,"messages"),{message:m,email:l.email,photoURL:l.photoURL,uid:l.uid,createdAt:Date.now()}))}we(oe,a=>{a?(console.log(a),s(0,l={email:a.email,uid:a.uid,photoURL:a.photoURL})):re("/")});let f="";function p(){ye(oe).then(()=>{re("/")}).catch(a=>{s(3,f=a)})}return[l,r,n,f,c,p]}class Ge extends ue{constructor(e){super();fe(this,e,ze,Ve,_e,{})}}export{Ge as default};
